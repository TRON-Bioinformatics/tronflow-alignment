image: openjdk:11.0.10-jre-buster

# include: '/environment.yml'

before_script:
  - java -version
  - apt-get update && apt-get install wget make
  - wget -qO- https://get.nextflow.io | bash && cp nextflow /usr/local/bin/nextflow
  - nextflow help
  - wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
  - mkdir /root/.conda
  - bash Miniconda3-latest-Linux-x86_64.sh -b && cp /root/miniconda3/bin/* /usr/local/bin/
  - rm -f Miniconda3-latest-Linux-x86_64.sh
  - conda --version

stages:
  - test

test:
  stage: test
  script:
    #nextflow run
    - make clean test-conda-aln-single
    #- nextflow main.nf -profile test,conda
    #- ll output
    - make clean test-conda-aln-paired
    #- nextflow main.nf -profile test,conda --library single
    #- ll output
    - make clean test-conda-mem-single
    #- nextflow main.nf -profile test,conda --algorithm mem
    #- ll output
    - make clean test-conda-mem-paired
    #- nextflow main.nf -profile test,conda --algorithm mem --library single
    #- ll output
